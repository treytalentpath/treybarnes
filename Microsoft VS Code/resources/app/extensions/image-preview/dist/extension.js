!function(e,t){for(var i in t)e[i]=t[i]}(exports,function(e){var t={};function i(n){if(t[n])return t[n].exports;var r=t[n]={i:n,l:!1,exports:{}};return e[n].call(r.exports,r,r.exports,i),r.l=!0,r.exports}return i.m=e,i.c=t,i.d=function(e,t,n){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(i.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var r in e)i.d(n,r,function(t){return e[t]}.bind(null,r));return n},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="",i(i.s=4)}([function(e,t){e.exports=require("vscode")},function(e,t){e.exports=require("path")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n,r,s,o,a,l=i(1),c=i(6),u=Object.prototype.toString;function d(e){return void 0!==e}function h(e){return"[object String]"===u.call(e)}function g(e){return JSON.parse(c.readFileSync(e,"utf8"))}function f(e,t){return a&&(e="［"+e.replace(/[aouei]/g,"$&$&")+"］"),0===t.length?e:e.replace(/\{(\d+)\}/g,function(e,i){var n=i[0],r=t[n],s=e;return"string"==typeof r?s=r:"number"!=typeof r&&"boolean"!=typeof r&&void 0!==r&&null!==r||(s=String(r)),s})}function p(e){return function(t,i){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];return function(e){return"[object Number]"===u.call(e)}(t)?t>=e.length?void console.error("Broken localize call found. Index out of bounds. Stacktrace is\n: "+new Error("").stack):f(e[t],n):h(i)?(console.warn("Message "+i+" didn't get externalized correctly."),f(i,n)):void console.error("Broken localize call found. Stacktrace is\n: "+new Error("").stack)}}function v(e,t){for(var i=[],n=2;n<arguments.length;n++)i[n-2]=arguments[n];return f(t,i)}function m(e,t){return s[e]=t,t}function w(e,t){var i,n=l.join(o.cacheRoot,e.id+"-"+e.hash+".json"),r=!1,s=!1;try{return i=JSON.parse(c.readFileSync(n,{encoding:"utf8",flag:"r"})),function(e){var t=new Date;c.utimes(e,t,t,function(){})}(n),i}catch(e){if("ENOENT"===e.code)s=!0;else{if(!(e instanceof SyntaxError))throw e;console.log("Syntax error parsing message bundle: "+e.message+"."),c.unlink(n,function(e){e&&console.error("Deleting corrupted bundle "+n+" failed.")}),r=!0}}if(!(i=function(e,t){var i=o.translationsConfig[e.id];if(i){var n=g(i).contents,r=g(l.join(t,"nls.metadata.json")),s=Object.create(null);for(var a in r){var c=r[a],u=n[e.outDir+"/"+a];if(u){for(var d=[],f=0;f<c.keys.length;f++){var p=c.keys[f],v=u[h(p)?p:p.key];void 0===v&&(v=c.messages[f]),d.push(v)}s[a]=d}else s[a]=c.messages}return s}}(e,t))||r)return i;if(s)try{c.writeFileSync(n,JSON.stringify(i),{encoding:"utf8",flag:"wx"})}catch(e){if("EEXIST"===e.code)return i;throw e}return i}function b(e){try{return function(e){var t=g(l.join(e,"nls.metadata.json")),i=Object.create(null);for(var n in t){var r=t[n];i[n]=r.messages}return i}(e)}catch(e){return void console.log("Generating default bundle from meta data failed.",e)}}function S(e,t){var i;if(!0===o.languagePackSupport&&void 0!==o.cacheRoot&&void 0!==o.languagePackId&&void 0!==o.translationsConfigFile&&void 0!==o.translationsConfig)try{i=w(e,t)}catch(e){console.log("Load or create bundle failed ",e)}if(!i){if(o.languagePackSupport)return b(t);var n=function(e){for(var t=o.locale;t;){var i=l.join(e,"nls.bundle."+t+".json");if(c.existsSync(i))return i;var n=t.lastIndexOf("-");t=n>0?t.substring(0,n):void 0}if(void 0===t&&(i=l.join(e,"nls.bundle.json"),c.existsSync(i)))return i}(t);if(n)try{return g(n)}catch(e){console.log("Loading in the box message bundle failed.",e)}i=b(t)}return i}function y(e){if(!e)return v;var t=l.extname(e);if(t&&(e=e.substr(0,e.length-t.length)),o.messageFormat===n.both||o.messageFormat===n.bundle){var i=function(e){for(var t,i=l.dirname(e);t=l.join(i,"nls.metadata.header.json"),!c.existsSync(t);){var n=l.dirname(i);if(n===i){t=void 0;break}i=n}return t}(e);if(i){var r=l.dirname(i),u=s[r];if(void 0===u)try{var h=JSON.parse(c.readFileSync(i,"utf8"));try{var f=S(h,r);u=m(r,f?{header:h,nlsBundle:f}:null)}catch(e){console.error("Failed to load nls bundle",e),u=m(r,null)}}catch(e){console.error("Failed to read header file",e),u=m(r,null)}if(u){var w=e.substr(r.length+1).replace(/\\/g,"/"),b=u.nlsBundle[w];return void 0===b?(console.error("Messages for file "+e+" not found. See console for details."),function(){return"Messages not found."}):p(b)}}}if(o.messageFormat===n.both||o.messageFormat===n.file)try{var y=g(function(e){var t;if(o.cacheLanguageResolution&&t)t=t;else{if(a||!o.locale)t=".nls.json";else for(var i=o.locale;i;){var n=".nls."+i+".json";if(c.existsSync(e+n)){t=n;break}var r=i.lastIndexOf("-");r>0?i=i.substring(0,r):(t=".nls.json",i=null)}o.cacheLanguageResolution&&(t=t)}return e+t}(e));return Array.isArray(y)?p(y):d(y.messages)&&d(y.keys)?p(y.messages):(console.error("String bundle '"+e+"' uses an unsupported format."),function(){return"File bundle has unsupported format. See console for details"})}catch(e){"ENOENT"!==e.code&&console.error("Failed to load single file bundle",e)}return console.error("Failed to load message bundle for file "+e),function(){return"Failed to load message bundle. See console for details."}}!function(e){e.file="file",e.bundle="bundle",e.both="both"}(n=t.MessageFormat||(t.MessageFormat={})),function(e){e.is=function(e){var t=e;return t&&d(t.key)&&d(t.comment)}}(r||(r={})),function(){if(o={locale:void 0,languagePackSupport:!1,cacheLanguageResolution:!0,messageFormat:n.bundle},h(process.env.VSCODE_NLS_CONFIG))try{var e=JSON.parse(process.env.VSCODE_NLS_CONFIG);if(h(e.locale)&&(o.locale=e.locale.toLowerCase()),function(e){return!0===e||!1===e}(e._languagePackSupport)&&(o.languagePackSupport=e._languagePackSupport),h(e._cacheRoot)&&(o.cacheRoot=e._cacheRoot),h(e._languagePackId)&&(o.languagePackId=e._languagePackId),h(e._translationsConfigFile)){o.translationsConfigFile=e._translationsConfigFile;try{o.translationsConfig=g(o.translationsConfigFile)}catch(t){e._corruptedFile&&c.writeFile(e._corruptedFile,"corrupted","utf8",function(e){console.error(e)})}}}catch(e){}a="pseudo"===o.locale,void 0,s=Object.create(null)}(),t.loadMessageBundle=y,t.config=function(e){return e&&(h(e.locale)&&(o.locale=e.locale.toLowerCase(),void 0,s=Object.create(null)),void 0!==e.messageFormat&&(o.messageFormat=e.messageFormat)),a="pseudo"===o.locale,y}},function(e,t,i){"use strict";function n(e){for(;e.length;){const t=e.pop();t&&t.dispose()}}Object.defineProperty(t,"__esModule",{value:!0}),t.disposeAll=n;t.Disposable=class{constructor(){this._isDisposed=!1,this._disposables=[]}dispose(){this._isDisposed||(this._isDisposed=!0,n(this._disposables))}_register(e){return this._isDisposed?e.dispose():this._disposables.push(e),e}get isDisposed(){return this._isDisposed}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(5),s=i(7),o=i(8);t.activate=function(e){const t=n.Uri.file(e.extensionPath),i=new s.SizeStatusBarEntry;e.subscriptions.push(i);const a=new o.ZoomStatusBarEntry;e.subscriptions.push(a),e.subscriptions.push(n.window.registerWebviewEditorProvider(r.Preview.viewType,{async resolveWebviewEditor(e,n){new r.Preview(t,e,n,i,a)}}))}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(2),s=i(3),o=r.loadMessageBundle(i(1).join(__dirname,"preview.ts"));class a extends s.Disposable{constructor(e,t,i,r,s){super(),this.extensionRoot=e,this.resource=t,this.webviewEditor=i,this.sizeStatusBarEntry=r,this.zoomStatusBarEntry=s,this.id=`${Date.now()}-${Math.random().toString()}`,this._previewState=1;const o=t.with({path:t.path.replace(/\/[^\/]+?\.\w+$/,"/")});i.webview.options={enableScripts:!0,localResourceRoots:[o,e]},this._register(i.webview.onDidReceiveMessage(e=>{switch(e.type){case"size":this._imageSize=e.value,this.update();break;case"zoom":this._imageZoom=e.value,this.update()}})),this._register(s.onDidChangeScale(e=>{2===this._previewState&&this.webviewEditor.webview.postMessage({type:"setScale",scale:e.scale})})),this._register(i.onDidChangeViewState(()=>{this.update()})),this._register(i.onDidDispose(()=>{2===this._previewState&&(this.sizeStatusBarEntry.hide(this.id),this.zoomStatusBarEntry.hide(this.id)),this._previewState=0}));const a=this._register(n.workspace.createFileSystemWatcher(t.fsPath));this._register(a.onDidChange(e=>{e.toString()===this.resource.toString()&&this.render()})),this._register(a.onDidDelete(e=>{e.toString()===this.resource.toString()&&this.webviewEditor.dispose()})),this.render(),this.update()}render(){0!==this._previewState&&(this.webviewEditor.webview.html=this.getWebiewContents())}update(){0!==this._previewState&&(this.webviewEditor.active?(this._previewState=2,this.sizeStatusBarEntry.show(this.id,this._imageSize||""),this.zoomStatusBarEntry.show(this.id,this._imageZoom||"fit")):(2===this._previewState&&(this.sizeStatusBarEntry.hide(this.id),this.zoomStatusBarEntry.hide(this.id)),this._previewState=1))}getWebiewContents(){const e=Date.now().toString(),t={isMac:"darwin"===process.platform,src:this.getResourcePath(this.webviewEditor,this.resource,e)},i=Date.now().toString();return`<!DOCTYPE html>\n<html lang="en">\n<head>\n\t<meta charset="UTF-8">\n\t<meta name="viewport" content="width=device-width, initial-scale=1.0">\n\t<meta http-equiv="X-UA-Compatible" content="ie=edge">\n\t<title>Image Preview</title>\n\t<link rel="stylesheet" href="${l(this.extensionResource("/media/main.css"))}" type="text/css" media="screen" nonce="${i}">\n\t<meta http-equiv="Content-Security-Policy" content="default-src 'none'; img-src 'self' data: ${this.webviewEditor.webview.cspSource}; script-src 'nonce-${i}'; style-src 'self' 'nonce-${i}';">\n\t<meta id="image-preview-settings" data-settings="${l(JSON.stringify(t))}">\n</head>\n<body class="container image scale-to-fit loading">\n\t<div class="loading-indicator"></div>\n\t<div class="image-load-error-message">${o(0,null)}</div>\n\t<script src="${l(this.extensionResource("/media/main.js"))}" nonce="${i}"><\/script>\n</body>\n</html>`}getResourcePath(e,t,i){switch(t.scheme){case"data":return encodeURI(t.toString(!0));case"git":return encodeURI("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAEElEQVR42gEFAPr/AP///wAI/AL+Sr4t6gAAAABJRU5ErkJggg==");default:return encodeURI(e.webview.asWebviewUri(t).toString(!0)+`?version=${i}`)}}extensionResource(e){return this.webviewEditor.webview.asWebviewUri(this.extensionRoot.with({path:this.extensionRoot.path+e}))}}function l(e){return e.toString().replace(/"/g,"&quot;")}t.Preview=a,a.viewType="imagePreview.previewEditor"},function(e,t){e.exports=require("fs")},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(3),s=i(2).loadMessageBundle(i(1).join(__dirname,"sizeStatusBarEntry.ts"));t.SizeStatusBarEntry=class extends r.Disposable{constructor(){super(),this._entry=this._register(n.window.createStatusBarItem({id:"imagePreview.size",name:s(0,null),alignment:n.StatusBarAlignment.Right,priority:101}))}show(e,t){this._showingOwner=e,this._entry.text=t,this._entry.show()}hide(e){e===this._showingOwner&&(this._entry.hide(),this._showingOwner=void 0)}}},function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});const n=i(0),r=i(2),s=i(3),o=r.loadMessageBundle(i(1).join(__dirname,"zoomStatusBarEntry.ts")),a="_imagePreview.selectZoomLevel";t.ZoomStatusBarEntry=class extends s.Disposable{constructor(){super(),this._onDidChangeScale=this._register(new n.EventEmitter),this.onDidChangeScale=this._onDidChangeScale.event,this._entry=this._register(n.window.createStatusBarItem({id:"imagePreview.zoom",name:o(0,null),alignment:n.StatusBarAlignment.Right,priority:102})),this._register(n.commands.registerCommand(a,async()=>{const e=[10,5,2,1,.5,.2,"fit"].map(e=>({label:this.zoomLabel(e),scale:e})),t=await n.window.showQuickPick(e,{placeHolder:o(1,null)});t&&this._onDidChangeScale.fire({scale:t.scale})})),this._entry.command=a}show(e,t){this._showOwner=e,this._entry.text=this.zoomLabel(t),this._entry.show()}hide(e){e===this._showOwner&&(this._entry.hide(),this._showOwner=void 0)}zoomLabel(e){return"fit"===e?o(2,null):`${Math.round(100*e)}%`}}}]));
//# sourceMappingURL=https://ticino.blob.core.windows.net/sourcemaps/6ab598523be7a800d7f3eb4d92d7ab9a66069390/extensions/image-preview/dist/extension.js.map